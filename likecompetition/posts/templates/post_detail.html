{% extends 'base.html' %}
{% load hitcount_tags %} 

{% block title %}
<link rel="stylesheet" type="text/css" href="">
{% endblock %}

{% block content %}
<h1>{{ post.title }}</h1>
글번호 : {{ post.id }}<br>
작성자 : {{ post.user }}<br>
날짜 : {{ post.date }}<br>
{% comment %} 성별 : {{ request.user }}<br> {% endcomment %}
{% comment %} 나이 : {{ post.user.birth }}<br> {% endcomment %}
지역 : {{ post.city }} {{ post.area }}<br>
분야 : {{ post.field }}<br>
툴 : 다 잘해요<br>
내용 : {{ post.content|linebreaks }}
조회수 : {% get_hit_count for post %}<br>

{% if request.user == post.user %}
	<a href="{% url 'posts:post_edit' post.id %}">수정하기</a>
	<a href="#" onclick="deletePost('{{ post.id }}')">삭제하기</a>
{% endif %}
<br><br><br>

{% for comment in comments %}
	작성자 : {{ comment.user.nickname }}<br>
	날짜 : {{ comment.date }}<br>
	내용 : {{ comment.content|linebreaks }}
	{% if request.user == comment.user %}
		<a href="#" onclick="deleteComment('{{ comment.id }}')">삭제하기</a>
	{% endif %}
	<br><br>
{% endfor %}

<form action="{% url 'posts:comment_create' post.id %}" method="post">
	{% csrf_token %}
	{{ form.as_p }}
	<input type="submit" value="등록" />
</form>
{% endblock %}

{% block end %}
<script>
	function deletePost(post_id) {
		axios.delete('/posts/' + post_id)
		.then(function(response) {
			location.href = '/';
		})
		.catch(function(error) {
			console.log(error);
		});
	}

	function deleteComment(comment_id) {
		axios.delete('/posts/comments/' + comment_id)
		.then(function(response) {
			location.reload(true);
		})
		.catch(function(error) {
			console.log(error);
		});
	}
</script>
{% endblock %}
